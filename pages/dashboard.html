<!DOCTYPE html>
<html lang="zh-CN">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>首页 - Dashboard</title>
    <script src="https://cdn.tailwindcss.com"></script>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/echarts/5.4.3/echarts.min.js"></script>
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.0/css/all.min.css">
    <style>
        :root {
            /* 核心配色方案 */
            --color-primary: #6366f1; /* Indigo 500 */
            --color-secondary: #0ea5e9; /* Sky 500 */
            --color-accent: #f59e0b; /* Amber 500 */
            --color-success: #10b981; /* Emerald 500 */
            --color-danger: #f43f5e; /* Rose 500 */
            --color-info: #8b5cf6; /* Violet 500 */
            --color-bg-card: rgba(255, 255, 255, 0.9);
            --color-text-main: #1f2937;
            --color-text-sub: #6b7280;
            
            /* 动效参数 */
            --ease-out-back: cubic-bezier(0.34, 1.56, 0.64, 1);
            --ease-smooth: cubic-bezier(0.4, 0, 0.2, 1);
        }

        body { font-family: -apple-system, BlinkMacSystemFont, 'Segoe UI', Roboto, 'Helvetica Neue', Arial, sans-serif; }
        
        /* 自定义滚动条 */
        ::-webkit-scrollbar { width: 6px; height: 6px; }
        ::-webkit-scrollbar-track { background: transparent; }
        ::-webkit-scrollbar-thumb { background: #cbd5e1; border-radius: 3px; }
        ::-webkit-scrollbar-thumb:hover { background: #94a3b8; }

        /* 卡片玻璃拟态/轻拟态效果 */
        .dashboard-card {
            background: var(--color-bg-card);
            border: 1px solid rgba(255, 255, 255, 0.5);
            box-shadow: 0 4px 6px -1px rgba(0, 0, 0, 0.05), 0 2px 4px -1px rgba(0, 0, 0, 0.03);
            border-radius: 0.75rem; /* rounded-xl */
            transition: all 0.4s var(--ease-smooth);
        }
        .dashboard-card:hover {
            box-shadow: 0 10px 15px -3px rgba(0, 0, 0, 0.08), 0 4px 6px -2px rgba(0, 0, 0, 0.04);
            transform: translateY(-2px);
        }

        /* 快捷入口 hover 动效 */
        .quick-access-item {
            transition: all 0.4s var(--ease-smooth);
        }
        .quick-access-item:hover {
            transform: translateY(-5px);
            box-shadow: 0 20px 25px -5px rgba(0, 0, 0, 0.1), 0 10px 10px -5px rgba(0, 0, 0, 0.04);
            background-color: #ffffff;
        }
        .quick-access-item:active {
            transform: scale(0.95);
            transition-duration: 0.1s;
        }
        .icon-box {
            transition: all 0.4s var(--ease-out-back);
        }
        .quick-access-item:hover .icon-box {
            transform: scale(1.15);
        }

        /* 顶部指标卡片 - 已移除旧版 stat-card 样式，改用 Tailwind Utility Classes 实现更生动的效果 */

        /* 图表容器 */
        .chart-container {
            width: 100%;
            height: 100%;
            min-height: 300px;
        }
    </style>
</head>
<body class="p-4 bg-gray-50 min-h-screen">
    
    <!-- 1. 核心指标卡片区域 (6个) -->
    <div class="grid grid-cols-1 md:grid-cols-2 lg:grid-cols-3 xl:grid-cols-6 gap-4 mb-4">
        <!-- 卡片 1: 蓝色主题 -->
        <div class="dashboard-card p-4 flex flex-col justify-between h-24 group hover:shadow-xl hover:shadow-blue-200 hover:border-blue-300 hover:bg-gradient-to-br hover:from-white hover:to-blue-50 transition-all duration-300 cursor-default">
            <div class="flex justify-between items-start">
                <span class="text-gray-500 text-xs font-medium group-hover:text-blue-600 transition-colors">教师用户数</span>
                <div class="w-8 h-8 rounded-lg bg-blue-50 text-blue-500 flex items-center justify-center transition-all duration-300 group-hover:scale-110 group-hover:rotate-6 group-hover:bg-blue-500 group-hover:text-white group-hover:shadow-md group-hover:shadow-blue-200">
                    <i class="fas fa-chalkboard-teacher"></i>
                </div>
            </div>
            <div class="text-2xl font-bold text-gray-800 mt-2 group-hover:text-blue-700 transition-colors">3,000</div>
        </div>
        <!-- 卡片 2: 绿色主题 -->
        <div class="dashboard-card p-4 flex flex-col justify-between h-24 group hover:shadow-xl hover:shadow-green-200 hover:border-green-300 hover:bg-gradient-to-br hover:from-white hover:to-green-50 transition-all duration-300 cursor-default">
            <div class="flex justify-between items-start">
                <span class="text-gray-500 text-xs font-medium group-hover:text-green-600 transition-colors">学生用户数</span>
                <div class="w-8 h-8 rounded-lg bg-green-50 text-green-500 flex items-center justify-center transition-all duration-300 group-hover:scale-110 group-hover:rotate-6 group-hover:bg-green-500 group-hover:text-white group-hover:shadow-md group-hover:shadow-green-200">
                    <i class="fas fa-user-graduate"></i>
                </div>
            </div>
            <div class="text-2xl font-bold text-gray-800 mt-2 group-hover:text-green-700 transition-colors">27,600</div>
        </div>
        <!-- 卡片 3: 紫色主题 -->
        <div class="dashboard-card p-4 flex flex-col justify-between h-24 group hover:shadow-xl hover:shadow-purple-200 hover:border-purple-300 hover:bg-gradient-to-br hover:from-white hover:to-purple-50 transition-all duration-300 cursor-default">
            <div class="flex justify-between items-start">
                <span class="text-gray-500 text-xs font-medium group-hover:text-purple-600 transition-colors">创建课程数</span>
                <div class="w-8 h-8 rounded-lg bg-purple-50 text-purple-500 flex items-center justify-center transition-all duration-300 group-hover:scale-110 group-hover:rotate-6 group-hover:bg-purple-500 group-hover:text-white group-hover:shadow-md group-hover:shadow-purple-200">
                    <i class="fas fa-book-open"></i>
                </div>
            </div>
            <div class="text-2xl font-bold text-gray-800 mt-2 group-hover:text-purple-700 transition-colors">2,510</div>
        </div>
        <!-- 卡片 4: 橙色主题 -->
        <div class="dashboard-card p-4 flex flex-col justify-between h-24 group hover:shadow-xl hover:shadow-orange-200 hover:border-orange-300 hover:bg-gradient-to-br hover:from-white hover:to-orange-50 transition-all duration-300 cursor-default">
            <div class="flex justify-between items-start">
                <span class="text-gray-500 text-xs font-medium group-hover:text-orange-600 transition-colors">总活动数</span>
                <div class="w-8 h-8 rounded-lg bg-orange-50 text-orange-500 flex items-center justify-center transition-all duration-300 group-hover:scale-110 group-hover:rotate-6 group-hover:bg-orange-500 group-hover:text-white group-hover:shadow-md group-hover:shadow-orange-200">
                    <i class="fas fa-chart-line"></i>
                </div>
            </div>
            <div class="text-2xl font-bold text-gray-800 mt-2 group-hover:text-orange-700 transition-colors">1,800,418</div>
        </div>
        <!-- 卡片 5: 靛蓝主题 -->
        <div class="dashboard-card p-4 flex flex-col justify-between h-24 group hover:shadow-xl hover:shadow-indigo-200 hover:border-indigo-300 hover:bg-gradient-to-br hover:from-white hover:to-indigo-50 transition-all duration-300 cursor-default">
            <div class="flex justify-between items-start">
                <span class="text-gray-500 text-xs font-medium group-hover:text-indigo-600 transition-colors">教师活动次数</span>
                <div class="w-8 h-8 rounded-lg bg-indigo-50 text-indigo-500 flex items-center justify-center transition-all duration-300 group-hover:scale-110 group-hover:rotate-6 group-hover:bg-indigo-500 group-hover:text-white group-hover:shadow-md group-hover:shadow-indigo-200">
                    <i class="fas fa-chalkboard"></i>
                </div>
            </div>
            <div class="text-2xl font-bold text-gray-800 mt-2 group-hover:text-indigo-700 transition-colors">947,727</div>
        </div>
        <!-- 卡片 6: 粉色主题 -->
        <div class="dashboard-card p-4 flex flex-col justify-between h-24 group hover:shadow-xl hover:shadow-pink-200 hover:border-pink-300 hover:bg-gradient-to-br hover:from-white hover:to-pink-50 transition-all duration-300 cursor-default">
            <div class="flex justify-between items-start">
                <span class="text-gray-500 text-xs font-medium group-hover:text-pink-600 transition-colors">学生活动次数</span>
                <div class="w-8 h-8 rounded-lg bg-pink-50 text-pink-500 flex items-center justify-center transition-all duration-300 group-hover:scale-110 group-hover:rotate-6 group-hover:bg-pink-500 group-hover:text-white group-hover:shadow-md group-hover:shadow-pink-200">
                    <i class="fas fa-users"></i>
                </div>
            </div>
            <div class="text-2xl font-bold text-gray-800 mt-2 group-hover:text-pink-700 transition-colors">852,691</div>
        </div>
    </div>

    <!-- 2. 中间层：活跃趋势 + 功能使用 + 快捷入口 -->
    <div class="flex flex-col lg:flex-row gap-4 mb-4">
        
        <!-- 左侧：总活跃趋势 (占 53%) -->
        <div class="dashboard-card p-4 flex flex-col w-full lg:w-[53%]">
            <div class="flex items-center mb-6">
                <!-- 左侧：趋势切换 Tabs -->
                <div class="flex-1 flex space-x-2 lg:space-x-4 items-baseline overflow-hidden" id="trend-tabs">
                    <span class="cursor-pointer text-gray-900 font-extrabold text-lg lg:text-xl whitespace-nowrap transition-all duration-300 ease-[cubic-bezier(0.34,1.56,0.64,1)]" data-tab="total">总活跃趋势</span>
                    <span class="cursor-pointer text-gray-500 font-normal text-sm lg:text-base hover:text-gray-700 whitespace-nowrap transition-all duration-300 ease-[cubic-bezier(0.34,1.56,0.64,1)]" data-tab="teacher">教师活跃趋势</span>
                    <span class="cursor-pointer text-gray-500 font-normal text-sm lg:text-base hover:text-gray-700 whitespace-nowrap transition-all duration-300 ease-[cubic-bezier(0.34,1.56,0.64,1)]" data-tab="student">学生活动趋势</span>
                </div>
                <!-- 右侧：时间维度切换 (与下方活跃排名列表对齐) -->
                <div class="w-48 pl-4 ml-2 flex-shrink-0">
                    <div class="flex bg-gray-200 rounded-lg p-1 text-xs w-full relative isolate" id="time-btns">
                        <!-- 滑块背景 -->
                        <div id="time-slider" class="absolute top-1 bottom-1 left-0 bg-white rounded-full shadow-sm transition-all duration-300 ease-[cubic-bezier(0.4,0,0.2,1)] z-0"></div>
                        <!-- 按钮 -->
                        <button class="flex-1 py-1 rounded-full text-gray-500 font-medium transition-colors relative z-10 hover:text-gray-700 flex items-center justify-center text-center" data-time="today">今日</button>
                        <button class="flex-1 py-1 rounded-full text-gray-500 font-medium transition-colors relative z-10 hover:text-gray-700 flex items-center justify-center text-center" data-time="week">本周</button>
                        <button class="flex-1 py-1 rounded-full text-gray-500 font-medium transition-colors relative z-10 hover:text-gray-700 flex items-center justify-center text-center" data-time="month">本月</button>
                        <button class="flex-1 py-1 rounded-full text-gray-500 font-medium transition-colors relative z-10 hover:text-gray-700 flex items-center justify-center text-center" data-time="year">全年</button>
                    </div>
                </div>
            </div>
            <div class="flex flex-1 min-h-0">
                <!-- 折线图 -->
                <div id="trendChart" class="flex-1 h-full w-0"></div>
                <!-- 活跃课程 Top5 -->
                <div class="w-48 border-l border-gray-100 pl-4 ml-2 flex flex-col h-full justify-center flex-shrink-0">
                    <h4 class="text-sm font-bold text-gray-700 mb-6 mt-2">活跃课程排名</h4>
                    <ul id="ranking-list" class="flex flex-col justify-center text-xs text-gray-600 pb-2 space-y-6 flex-1">
                        <!-- 由 JS 动态渲染 -->
                    </ul>
                </div>
            </div>
        </div>

        <!-- 中间：功能使用情况 (占 27%) -->
        <div class="dashboard-card p-4 w-full lg:w-[27%]">
            <h3 class="font-bold text-gray-800 mb-4">功能使用情况</h3>
            <div id="pieChart" class="h-[300px] w-full"></div>
        </div>

        <!-- 右侧：快捷入口 (占 20%) -->
        <div class="dashboard-card p-4 w-full lg:w-[20%]">
            <div class="flex justify-between items-center mb-4">
                <h3 class="font-bold text-gray-800">常用功能</h3>
                <i class="fas fa-cog text-gray-400 cursor-pointer hover:text-blue-600"></i>
            </div>
            <div class="grid grid-cols-3 gap-3">
                <a href="#" class="quick-access-item group flex flex-col items-center justify-center p-3 rounded-2xl hover:bg-white transition-all">
                    <div class="icon-box w-12 h-12 rounded-2xl bg-blue-50 text-blue-600 flex items-center justify-center mb-2 group-hover:bg-blue-500 group-hover:text-white group-hover:shadow-lg group-hover:shadow-blue-200">
                        <i class="fas fa-tachometer-alt text-lg"></i>
                    </div>
                    <span class="text-xs text-gray-600 text-center whitespace-nowrap font-medium transition-colors group-hover:text-blue-600">数据面板</span>
                </a>
                <a href="#" class="quick-access-item group flex flex-col items-center justify-center p-3 rounded-2xl hover:bg-white transition-all">
                    <div class="icon-box w-12 h-12 rounded-2xl bg-purple-50 text-purple-600 flex items-center justify-center mb-2 group-hover:bg-purple-500 group-hover:text-white group-hover:shadow-lg group-hover:shadow-purple-200">
                        <i class="fas fa-chart-pie text-lg"></i>
                    </div>
                    <span class="text-xs text-gray-600 text-center whitespace-nowrap font-medium transition-colors group-hover:text-purple-600">使用情况</span>
                </a>
                <a href="#" class="quick-access-item group flex flex-col items-center justify-center p-3 rounded-2xl hover:bg-white transition-all">
                    <div class="icon-box w-12 h-12 rounded-2xl bg-emerald-50 text-emerald-600 flex items-center justify-center mb-2 group-hover:bg-emerald-500 group-hover:text-white group-hover:shadow-lg group-hover:shadow-emerald-200">
                        <i class="fas fa-calendar-alt text-lg"></i>
                    </div>
                    <span class="text-xs text-gray-600 text-center whitespace-nowrap font-medium transition-colors group-hover:text-emerald-600">排课管理</span>
                </a>
                <a href="#" class="quick-access-item group flex flex-col items-center justify-center p-3 rounded-2xl hover:bg-white transition-all">
                    <div class="icon-box w-12 h-12 rounded-2xl bg-orange-50 text-orange-600 flex items-center justify-center mb-2 group-hover:bg-orange-500 group-hover:text-white group-hover:shadow-lg group-hover:shadow-orange-200">
                        <i class="fas fa-chalkboard-teacher text-lg"></i>
                    </div>
                    <span class="text-xs text-gray-600 text-center whitespace-nowrap font-medium transition-colors group-hover:text-orange-600">教师管理</span>
                </a>
                <a href="#" class="quick-access-item group flex flex-col items-center justify-center p-3 rounded-2xl hover:bg-white transition-all">
                    <div class="icon-box w-12 h-12 rounded-2xl bg-rose-50 text-rose-600 flex items-center justify-center mb-2 group-hover:bg-rose-500 group-hover:text-white group-hover:shadow-lg group-hover:shadow-rose-200">
                        <i class="fas fa-user-graduate text-lg"></i>
                    </div>
                    <span class="text-xs text-gray-600 text-center whitespace-nowrap font-medium transition-colors group-hover:text-rose-600">学生管理</span>
                </a>
                <a href="#" class="quick-access-item group flex flex-col items-center justify-center p-3 rounded-2xl hover:bg-white transition-all">
                    <div class="icon-box w-12 h-12 rounded-2xl bg-teal-50 text-teal-600 flex items-center justify-center mb-2 group-hover:bg-teal-500 group-hover:text-white group-hover:shadow-lg group-hover:shadow-teal-200">
                        <i class="fas fa-book text-lg"></i>
                    </div>
                    <span class="text-xs text-gray-600 text-center whitespace-nowrap font-medium transition-colors group-hover:text-teal-600">知识库管理</span>
                </a>
                <a href="#" class="quick-access-item group flex flex-col items-center justify-center p-3 rounded-2xl hover:bg-white transition-all">
                    <div class="icon-box w-12 h-12 rounded-2xl bg-indigo-50 text-indigo-600 flex items-center justify-center mb-2 group-hover:bg-indigo-500 group-hover:text-white group-hover:shadow-lg group-hover:shadow-indigo-200">
                        <i class="fas fa-clock text-lg"></i>
                    </div>
                    <span class="text-xs text-gray-600 text-center whitespace-nowrap font-medium transition-colors group-hover:text-indigo-600">学期管理</span>
                </a>
                <a href="#" class="quick-access-item group flex flex-col items-center justify-center p-3 rounded-2xl hover:bg-white transition-all">
                    <div class="icon-box w-12 h-12 rounded-2xl bg-cyan-50 text-cyan-600 flex items-center justify-center mb-2 group-hover:bg-cyan-500 group-hover:text-white group-hover:shadow-lg group-hover:shadow-cyan-200">
                        <i class="fas fa-search text-lg"></i>
                    </div>
                    <span class="text-xs text-gray-600 text-center whitespace-nowrap font-medium transition-colors group-hover:text-cyan-600">课程查询</span>
                </a>
            </div>
        </div>
    </div>

    <!-- 3. 底部层：发布题型统计 + 学院使用统计 + 当前活动行为 -->
    <div class="grid grid-cols-1 lg:grid-cols-[2.8fr_4.4fr_3.8fr] gap-4">
        
        <!-- 左侧：发布题型统计 (雷达图) -->
        <div class="dashboard-card p-4">
            <h3 class="font-bold text-gray-800 mb-4">发布题型统计</h3>
            <div id="radarChart" class="h-[300px] w-full"></div>
        </div>

        <!-- 中间：学院使用统计 (柱状图) -->
        <div class="dashboard-card p-4">
            <h3 class="font-bold text-gray-800 mb-4">学院使用统计</h3>
            <div id="barChart" class="h-[300px] w-full"></div>
        </div>

        <!-- 右侧：当前活动行为 (列表) -->
        <div class="dashboard-card p-4 flex flex-col h-[380px]"> <!-- 固定高度以支持滚动 -->
            <h3 class="font-bold text-gray-800 mb-4 flex-shrink-0">当前活动行为</h3>
            
            <!-- 表头 -->
            <div class="flex text-xs text-gray-500 border-b border-gray-100 pb-2 flex-shrink-0">
                <div class="w-[28%] pl-2">学院</div>
                <div class="w-[22%]">课程</div>
                <div class="w-[15%]">教师</div> <!-- 稍微增加教师宽度 -->
                <div class="w-[20%]">行为</div>
                <div class="w-[15%] text-right pr-2">时间</div>
            </div>

            <!-- 滚动列表容器 -->
            <div class="flex-1 overflow-hidden relative mt-2" id="activity-container">
                <div id="activity-list" class="absolute w-full top-0 left-0">
                    <!-- JS 动态生成内容 -->
                </div>
            </div>
        </div>
    </div>

    <script>
        // 初始化图表
        document.addEventListener('DOMContentLoaded', function() {
            initTrendChart();
            initPieChart();
            initRadarChart();
            initBarChart();
            initActivityList(); // 初始化活动列表滚动
            
            // 监听窗口大小变化，重绘图表
            window.addEventListener('resize', function() {
                echarts.getInstanceByDom(document.getElementById('trendChart')).resize();
                echarts.getInstanceByDom(document.getElementById('pieChart')).resize();
                echarts.getInstanceByDom(document.getElementById('radarChart')).resize();
                echarts.getInstanceByDom(document.getElementById('barChart')).resize();
            });
        });

        // 1. 折线图：总活跃趋势 (包含交互逻辑)
        function initTrendChart() {
            const chartDom = document.getElementById('trendChart');
            const chart = echarts.init(chartDom);
            
            // 模拟数据 - 趋势图
            const mockData = {
                total: {
                    today: { x: ['08:00', '10:00', '12:00', '14:00', '16:00', '18:00', '20:00'], y: [120, 280, 150, 300, 220, 180, 200] },
                    week: { x: ['周一', '周二', '周三', '周四', '周五', '周六', '周日'], y: [2400, 2900, 2800, 3500, 2500, 1500, 1800] },
                    month: { x: ['1日', '5日', '10日', '15日', '20日', '25日', '30日'], y: [8000, 9200, 8500, 10500, 9800, 7500, 8200] },
                    year: { x: ['1月', '2月', '3月', '4月', '5月', '6月', '7月', '8月', '9月', '10月', '11月', '12月'], y: [28000, 35000, 42000, 38000, 45000, 48000, 32000, 30000, 52000, 55000, 58000, 60000] }
                },
                teacher: {
                    today: { x: ['08:00', '10:00', '12:00', '14:00', '16:00', '18:00', '20:00'], y: [40, 80, 30, 90, 60, 40, 20] },
                    week: { x: ['周一', '周二', '周三', '周四', '周五', '周六', '周日'], y: [528, 600, 580, 800, 650, 200, 300] },
                    month: { x: ['1日', '5日', '10日', '15日', '20日', '25日', '30日'], y: [2000, 2500, 2200, 2800, 2600, 1500, 1800] },
                    year: { x: ['1月', '2月', '3月', '4月', '5月', '6月', '7月', '8月', '9月', '10月', '11月', '12月'], y: [8000, 9000, 10000, 9500, 11000, 12000, 5000, 4000, 13000, 14000, 15000, 16000] }
                },
                student: {
                    today: { x: ['08:00', '10:00', '12:00', '14:00', '16:00', '18:00', '20:00'], y: [80, 200, 120, 210, 160, 140, 180] },
                    week: { x: ['周一', '周二', '周三', '周四', '周五', '周六', '周日'], y: [1872, 2300, 2220, 2700, 1850, 1300, 1500] },
                    month: { x: ['1日', '5日', '10日', '15日', '20日', '25日', '30日'], y: [6000, 6700, 6300, 7700, 7200, 6000, 6400] },
                    year: { x: ['1月', '2月', '3月', '4月', '5月', '6月', '7月', '8月', '9月', '10月', '11月', '12月'], y: [20000, 26000, 32000, 28500, 34000, 36000, 27000, 26000, 39000, 41000, 43000, 44000] }
                }
            };

            // 模拟数据 - 活跃课程排名
            const rankingData = {
                today: [
                    { name: '高等数学', color: 'bg-red-50 text-red-500' },
                    { name: '大学英语', color: 'bg-orange-50 text-orange-500' },
                    { name: '计算机基础', color: 'bg-yellow-50 text-yellow-600' },
                    { name: '体育', color: 'bg-gray-100 text-gray-500' },
                    { name: '形势与政策', color: 'bg-gray-100 text-gray-500' }
                ],
                week: [
                    { name: '数字电视技术', color: 'bg-red-50 text-red-500' },
                    { name: '马克思主义', color: 'bg-orange-50 text-orange-500' },
                    { name: '5G+AI新一代信息技术', color: 'bg-yellow-50 text-yellow-600' },
                    { name: '新能源与可持续发展', color: 'bg-gray-100 text-gray-500' },
                    { name: '流体力学', color: 'bg-gray-100 text-gray-500' }
                ],
                month: [
                    { name: '数据结构', color: 'bg-red-50 text-red-500' },
                    { name: '操作系统', color: 'bg-orange-50 text-orange-500' },
                    { name: '计算机网络', color: 'bg-yellow-50 text-yellow-600' },
                    { name: '数据库原理', color: 'bg-gray-100 text-gray-500' },
                    { name: '软件工程', color: 'bg-gray-100 text-gray-500' }
                ],
                year: [
                    { name: 'Python编程', color: 'bg-red-50 text-red-500' },
                    { name: 'Java程序设计', color: 'bg-orange-50 text-orange-500' },
                    { name: 'Web前端开发', color: 'bg-yellow-50 text-yellow-600' },
                    { name: '人工智能导论', color: 'bg-gray-100 text-gray-500' },
                    { name: '大数据分析', color: 'bg-gray-100 text-gray-500' }
                ]
            };

            // 当前状态
            let currentTab = 'total';
            let currentTime = 'week';

            // 渲染图表函数
            function renderChart() {
                const data = mockData[currentTab][currentTime];
                const tabNameMap = { 'total': '总活跃趋势', 'teacher': '教师活跃趋势', 'student': '学生活动趋势' };
                const tabName = tabNameMap[currentTab];
                
                // 定义颜色映射
                const colorMap = {
                    'total': '#8b5cf6',   // 紫色
                    'teacher': '#3b82f6', // 蓝色
                    'student': '#10b981'  // 绿色
                };
                const currentColor = colorMap[currentTab];

                const option = {
                    tooltip: {
                        trigger: 'axis',
                        backgroundColor: 'rgba(255, 255, 255, 0.4)',
                        borderColor: 'rgba(255, 255, 255, 0.3)',
                        textStyle: { color: '#1f2937', fontSize: 12 },
                        extraCssText: 'backdrop-filter: blur(20px); box-shadow: 0 8px 32px 0 rgba(31, 38, 135, 0.15); border-radius: 12px; border: 1px solid rgba(255, 255, 255, 0.18);',
                        formatter: function (params) {
                            const date = params[0].name;
                            const value = params[0].value;
                            // 模拟更详细的 Tooltip 数据 (按比例生成)
                            let teacherVal, studentVal;
                            if (currentTab === 'teacher') {
                                teacherVal = value;
                                studentVal = 0;
                            } else if (currentTab === 'student') {
                                teacherVal = 0;
                                studentVal = value;
                            } else {
                                teacherVal = Math.floor(value * 0.25);
                                studentVal = value - teacherVal;
                            }

                            let html = `<div class="font-bold mb-1 border-b border-gray-100 pb-1">${date}</div>`;
                            if (currentTab === 'total') {
                                html += `<div class="flex items-center"><span class="w-2 h-2 rounded-full bg-blue-500 mr-2" style="background-color: #8b5cf6"></span>总活跃数: <b>${value}</b></div>`;
                                html += `<div class="flex items-center mt-1 text-xs text-gray-500"><span class="w-2 h-2 rounded-full bg-indigo-400 mr-2" style="background-color: #3b82f6"></span>教师: ${teacherVal}</div>`;
                                html += `<div class="flex items-center mt-1 text-xs text-gray-500"><span class="w-2 h-2 rounded-full bg-pink-400 mr-2" style="background-color: #10b981"></span>学生: ${studentVal}</div>`;
                            } else {
                                html += `<div class="flex items-center"><span class="w-2 h-2 rounded-full mr-2" style="background-color: ${currentColor}"></span>${tabName}: <b>${value}</b></div>`;
                            }
                            return html;
                        }
                    },
                    grid: {
                        top: '15%',
                        left: '2%',
                        right: '4%',
                        bottom: '3%',
                        containLabel: true
                    },
                    xAxis: {
                        type: 'category',
                        boundaryGap: false,
                        data: data.x,
                        axisLine: { show: false },
                        axisTick: { show: false },
                        axisLabel: { 
                            color: '#9ca3af',
                            interval: (index, value) => {
                                // 全年视图：只显示双数月份 (索引 1, 3, 5...)
                                if (currentTime === 'year') {
                                    return index % 2 !== 0;
                                }
                                return true; // 其他视图：显示所有
                            }
                        }
                    },
                    yAxis: {
                        type: 'value',
                        splitLine: {
                            lineStyle: { type: 'dashed', color: '#f3f4f6' }
                        },
                        axisLabel: { color: '#9ca3af' }
                    },
                    series: [{
                        name: tabName,
                        type: 'line',
                        smooth: true,
                        data: data.y,
                        itemStyle: { color: currentColor },
                        areaStyle: {
                            color: new echarts.graphic.LinearGradient(0, 0, 0, 1, [
                                { offset: 0, color: hexToRgba(currentColor, 0.2) },
                                { offset: 1, color: hexToRgba(currentColor, 0) }
                            ])
                        },
                        lineStyle: { width: 3 },
                        showSymbol: false,
                        emphasis: { showSymbol: true }
                    }]
                };
                chart.setOption(option);
            }
            
            // 辅助函数：Hex 转 RGBA
            function hexToRgba(hex, opacity) {
                let r = parseInt(hex.substring(1, 3), 16);
                let g = parseInt(hex.substring(3, 5), 16);
                let b = parseInt(hex.substring(5, 7), 16);
                return `rgba(${r}, ${g}, ${b}, ${opacity})`;
            }

            // 更新滑块位置
            function updateTimeSlider(activeBtn) {
                const slider = document.getElementById('time-slider');
                if (!slider || !activeBtn) return;
                
                const btnRect = activeBtn.getBoundingClientRect();
                const containerRect = activeBtn.parentElement.getBoundingClientRect();

                // 计算相对位置
                const left = btnRect.left - containerRect.left;
                const width = btnRect.width;

                slider.style.width = `${width}px`;
                slider.style.transform = `translateX(${left}px)`;
            }

            // 渲染排名列表
            function renderRankingList(time) {
                const list = document.getElementById('ranking-list');
                const data = rankingData[time] || rankingData['week'];
                
                // 清空并重新生成
                list.innerHTML = '';
                
                data.forEach((item, index) => {
                    const li = document.createElement('li');
                    li.className = 'truncate flex items-center group cursor-pointer opacity-0 transition-all duration-300';
                    li.style.animation = `fadeInRight 0.3s ease-out forwards ${index * 0.05}s`;
                    li.title = item.name;
                    
                    li.innerHTML = `
                        <span class="w-6 h-6 rounded-md ${item.color} font-bold flex items-center justify-center mr-3 text-sm transition-colors shadow-sm">${(index + 1).toString().padStart(2, '0')}</span>
                        <span class="group-hover:text-blue-600 transition-colors text-sm truncate flex-1">${item.name}</span>
                    `;
                    list.appendChild(li);
                });
            }

            // 添加 fadeInRight 动画样式
            const style = document.createElement('style');
            style.textContent = `
                @keyframes fadeInRight {
                    from { opacity: 0; transform: translateX(10px); }
                    to { opacity: 1; transform: translateX(0); }
                }
            `;
            document.head.appendChild(style);

            // 初始化
            const defaultTimeBtn = document.querySelector(`#time-btns button[data-time="${currentTime}"]`);
            if (defaultTimeBtn) {
                // 延迟一点初始化滑块，确保布局完成
                setTimeout(() => {
                    updateTimeSlider(defaultTimeBtn);
                    defaultTimeBtn.classList.remove('text-gray-500');
                    defaultTimeBtn.classList.add('text-gray-800', 'font-bold');
                }, 50);
            }
            renderChart();
            renderRankingList(currentTime);

            // 绑定交互事件
            // 1. Tab 切换
            const tabs = document.querySelectorAll('#trend-tabs span');
            tabs.forEach(tab => {
                tab.addEventListener('click', function() {
                    // 更新 Tab 样式
                    tabs.forEach(t => {
                        t.classList.remove('text-gray-900', 'font-extrabold', 'text-lg', 'lg:text-xl');
                        t.classList.add('text-gray-500', 'font-normal', 'text-sm', 'lg:text-base');
                    });
                    this.classList.remove('text-gray-500', 'font-normal', 'text-sm', 'lg:text-base');
                    this.classList.add('text-gray-900', 'font-extrabold', 'text-lg', 'lg:text-xl');
                    
                    // 更新数据
                    currentTab = this.getAttribute('data-tab');
                    renderChart();
                });
            });

            // 2. 时间切换
            const timeBtns = document.querySelectorAll('#time-btns button');
            timeBtns.forEach(btn => {
                btn.addEventListener('click', function() {
                    // 更新按钮样式
                    timeBtns.forEach(b => {
                        b.classList.remove('text-gray-800', 'font-bold');
                        b.classList.add('text-gray-500');
                    });
                    this.classList.remove('text-gray-500');
                    this.classList.add('text-gray-800', 'font-bold');

                    // 移动滑块
                    updateTimeSlider(this);

                    // 更新数据
                    currentTime = this.getAttribute('data-time');
                    renderChart();
                    renderRankingList(currentTime);
                });
            });
            
            // 响应 Resize
            window.addEventListener('resize', () => {
                chart.resize();
                // 重新计算滑块位置
                const activeBtn = document.querySelector(`#time-btns button[data-time="${currentTime}"]`);
                if(activeBtn) updateTimeSlider(activeBtn);
            });
        }

        // 2. 饼图：功能使用情况
        function initPieChart() {
            const chart = echarts.init(document.getElementById('pieChart'));
            const option = {
                tooltip: {
                    trigger: 'item',
                    backgroundColor: 'rgba(255, 255, 255, 0.4)',
                    borderColor: 'rgba(255, 255, 255, 0.3)',
                    textStyle: { color: '#1f2937' },
                    extraCssText: 'backdrop-filter: blur(20px); box-shadow: 0 8px 32px 0 rgba(31, 38, 135, 0.15); border-radius: 12px; border: 1px solid rgba(255, 255, 255, 0.18);',
                    formatter: '{b}: {c} ({d}%)'
                },
                legend: {
                    bottom: '0%',
                    left: 'center',
                    itemWidth: 12,
                    itemHeight: 12,
                    icon: 'circle',
                    textStyle: { color: '#64748b', fontSize: 12, padding: [0, 5] },
                    itemGap: 20
                },
                series: [{
                    name: '功能使用',
                    type: 'pie',
                    radius: ['45%', '65%'],
                    center: ['50%', '42%'],
                    avoidLabelOverlap: false,
                    itemStyle: {
                        borderRadius: 4,
                        borderColor: 'transparent',
                        borderWidth: 0
                    },
                    label: { show: false },
                    emphasis: {
                        scale: true,
                        scaleSize: 10,
                        itemStyle: {
                            borderColor: 'transparent',
                            borderWidth: 0,
                            shadowBlur: 30,
                            shadowOffsetX: 0,
                            shadowOffsetY: 10
                        }
                    },
                    data: [
                        {
                            value: 1048,
                            name: '签到',
                            itemStyle: {
                                color: new echarts.graphic.LinearGradient(0, 0, 0, 1, [
                                    { offset: 0, color: '#818cf8' }, // Indigo-400
                                    { offset: 1, color: '#4f46e5' }  // Indigo-600
                                ])
                            },
                            emphasis: { itemStyle: { shadowColor: 'rgba(99, 102, 241, 0.6)' } }
                        },
                        {
                            value: 735,
                            name: '发布作业',
                            itemStyle: {
                                color: new echarts.graphic.LinearGradient(0, 0, 0, 1, [
                                    { offset: 0, color: '#38bdf8' }, // Sky-400
                                    { offset: 1, color: '#0284c7' }  // Sky-600
                                ])
                            },
                            emphasis: { itemStyle: { shadowColor: 'rgba(14, 165, 233, 0.6)' } }
                        },
                        {
                            value: 580,
                            name: '发布问题',
                            itemStyle: {
                                color: new echarts.graphic.LinearGradient(0, 0, 0, 1, [
                                    { offset: 0, color: '#34d399' }, // Emerald-400
                                    { offset: 1, color: '#059669' }  // Emerald-600
                                ])
                            },
                            emphasis: { itemStyle: { shadowColor: 'rgba(16, 185, 129, 0.6)' } }
                        },
                        {
                            value: 484,
                            name: '上传资源',
                            itemStyle: {
                                color: new echarts.graphic.LinearGradient(0, 0, 0, 1, [
                                    { offset: 0, color: '#fbbf24' }, // Amber-400
                                    { offset: 1, color: '#d97706' }  // Amber-600
                                ])
                            },
                            emphasis: { itemStyle: { shadowColor: 'rgba(245, 158, 11, 0.6)' } }
                        }
                    ],
                    animationType: 'scale',
                    animationEasing: 'elasticOut',
                    animationDelay: function (idx) {
                        return Math.random() * 200;
                    }
                }]
            };
            chart.setOption(option);
        }

        // 3. 雷达图：发布题型统计
        function initRadarChart() {
            const chart = echarts.init(document.getElementById('radarChart'));
            const option = {
                tooltip: {
                    trigger: 'item',
                    backgroundColor: 'rgba(255, 255, 255, 0.4)',
                    borderColor: 'rgba(255, 255, 255, 0.3)',
                    textStyle: { color: '#1f2937' },
                    extraCssText: 'backdrop-filter: blur(20px); box-shadow: 0 8px 32px 0 rgba(31, 38, 135, 0.15); border-radius: 12px; border: 1px solid rgba(255, 255, 255, 0.18);'
                },
                radar: {
                    radius: '55%', // 缩小雷达图半径以适应容器 (原65%)
                    center: ['50%', '50%'],
                    indicator: [
                        { name: '简答题', max: 6500 },
                        { name: '图片题', max: 16000 },
                        { name: '判断题', max: 30000 },
                        { name: '单选题', max: 38000 },
                        { name: '多选题', max: 52000 }
                    ],
                    splitArea: {
                        areaStyle: {
                            color: ['#f8fafc', '#ffffff']
                        }
                    },
                    axisName: {
                        color: '#64748b'
                    }
                },
                series: [{
                    name: '发布题型',
                    type: 'radar',
                    data: [{
                        value: [4200, 10000, 20000, 35000, 45000],
                        name: '题型分布',
                        itemStyle: { color: '#3b82f6' },
                        areaStyle: { opacity: 0.2 }
                    }]
                }]
            };
            chart.setOption(option);
        }

        // 4. 柱状图：学院使用统计
        function initBarChart() {
            const chart = echarts.init(document.getElementById('barChart'));
            
            const option = {
                tooltip: {
                    trigger: 'axis',
                    axisPointer: { type: 'shadow' }, // 阴影指示器
                    backgroundColor: 'rgba(255, 255, 255, 0.4)',
                    borderColor: 'rgba(255, 255, 255, 0.3)',
                    textStyle: { color: '#1f2937' },
                    extraCssText: 'backdrop-filter: blur(20px); box-shadow: 0 8px 32px 0 rgba(31, 38, 135, 0.15); border-radius: 12px; border: 1px solid rgba(255, 255, 255, 0.18);'
                },
                grid: {
                    top: '15%',
                    left: '2%',
                    right: '2%',
                    bottom: '5%',
                    containLabel: true
                },
                xAxis: {
                    type: 'category',
                    data: ['电子电气学院', '马克思主义学院', '艺术设计学院', '纺织服装学院', '外国语学院', '城轨交通学院', '管理学院'],
                    axisTick: { show: false },
                    axisLine: { show: false }, // 隐藏轴线，极简风格
                    axisLabel: { 
                        interval: 0, 
                        fontSize: 10, // 缩小字体适应窄屏
                        color: '#64748b',
                        margin: 15,
                        formatter: function(value) {
                            return value.replace('学院', ''); // 去掉“学院”后缀
                        }
                    }
                },
                yAxis: {
                    type: 'value',
                    splitLine: {
                        lineStyle: { type: 'dashed', color: '#f1f5f9' } // 更淡的分割线
                    },
                    axisLabel: { color: '#94a3b8' }
                },
                series: [{
                    name: '使用活跃度',
                    data: [3800, 2100, 3000, 1500, 2000, 800, 2500],
                    type: 'bar',
                    barWidth: '45%', // 调整条形柱宽度适应 4.4fr 的空间
                    showBackground: true,
                    backgroundStyle: {
                        color: 'rgba(241, 245, 249, 0.5)', // 极淡的背景条
                        borderRadius: [3, 3, 3, 3]
                    },
                    itemStyle: {
                        borderRadius: [3, 3, 3, 3], // 减小圆角半径
                        color: new echarts.graphic.LinearGradient(0, 0, 0, 1, [
                            { offset: 0, color: '#ff7e5f' }, // 珊瑚橙
                            { offset: 1, color: '#feb47b' }  // 蜜桃橙
                        ])
                    },
                    emphasis: {
                        itemStyle: {
                            shadowBlur: 20,
                            shadowColor: '#ff7e5f', // 光晕颜色
                            shadowOffsetY: 5
                        }
                    },
                    animationEasing: 'elasticOut', // 呼应饼图的弹跳动画
                    animationDelay: function (idx) {
                        return idx * 100; // 阶梯式动画
                    }
                }]
            };
            chart.setOption(option);
        }

        // 5. 活动列表滚动逻辑
        function initActivityList() {
            const container = document.getElementById('activity-list');
            
            // 基础数据池
            const colleges = ['电子电气学院', '马克思主义学院', '艺术设计学院', '纺织服装学院', '管理学院', '外国语学院', '城轨交通学院'];
            const courses = ['嵌入式系统', '马克思主义', '生活中的艺术', '服装设计', '管理学概论', '英语视听说', '城市轨道交通'];
            const teachers = ['张三', '李四', '老五', '小二', '王六', '赵七', '孙八'];
            const actions = [
                { text: '发布签到', color: 'bg-blue-100 text-blue-600' },
                { text: '发布答题', color: 'bg-green-100 text-green-600' },
                { text: '发布抢答', color: 'bg-purple-100 text-purple-600' },
                { text: '发布作业', color: 'bg-orange-100 text-orange-600' },
                { text: '上传资源', color: 'bg-gray-100 text-gray-600' }
            ];
            
            // 初始生成10条数据
            let activityData = [];
            for (let i = 0; i < 10; i++) {
                activityData.push(generateRandomActivity(i));
            }

            // 渲染列表函数
            function renderList() {
                container.innerHTML = '';
                activityData.forEach(item => {
                    const div = document.createElement('div');
                    div.className = 'flex items-center py-3 border-b border-gray-50 text-xs text-gray-600 hover:bg-gray-50 transition-colors h-[50px]'; // 固定高度
                    div.innerHTML = `
                        <div class="w-[28%] pl-2 truncate" title="${item.college}">${item.college}</div>
                        <div class="w-[22%] truncate" title="${item.course}">${item.course}</div>
                        <div class="w-[15%] truncate">${item.teacher}</div>
                        <div class="w-[20%]"><span class="${item.actionColor} px-2 py-1 rounded scale-90 inline-block origin-left">${item.actionText}</span></div>
                        <div class="w-[15%] text-right pr-2 text-gray-400 text-[10px] whitespace-nowrap">${item.time}</div>
                    `;
                    container.appendChild(div);
                });
            }

            // 生成随机数据
            function generateRandomActivity(index, isNew = false) {
                const collegeIdx = Math.floor(Math.random() * colleges.length);
                const actionIdx = Math.floor(Math.random() * actions.length);
                
                let timeStr;
                if (isNew) {
                    // 新数据：大部分显示“刚刚”，偶尔显示“1分钟前”
                    timeStr = Math.random() > 0.3 ? '刚刚' : '1分钟前';
                } else {
                    // 初始数据：分布在 2分钟前 - 12小时前
                    const times = ['2分钟前', '10分钟前', '30分钟前', '1小时前', '2小时前', '5小时前', '12小时前'];
                    timeStr = times[index % times.length];
                }

                return {
                    college: colleges[collegeIdx],
                    course: courses[collegeIdx], // 简单对应
                    teacher: teachers[collegeIdx], // 简单对应
                    actionText: actions[actionIdx].text,
                    actionColor: actions[actionIdx].color,
                    time: timeStr
                };
            }

            // 初始渲染
            renderList();

            // 滚动动画逻辑
    const rowHeight = 50; // 与 CSS 中的 h-[50px] 一致
    let currentOffset = 0;

    function scrollDown() {
        // 1. DOM操作：将最后一个元素移到最前
        const lastChild = container.lastElementChild;
        if (!lastChild) return;
        container.insertBefore(lastChild, container.firstElementChild);
        
        // 2. 数据更新：同步更新数组顺序
        const lastItem = activityData.pop();
        activityData.unshift(lastItem);

        // 3. 动画准备：设置初始位置（向上偏移一行，使新插入的元素处于隐藏状态）
        container.style.transition = 'none';
        container.style.transform = `translateY(-${rowHeight}px)`;
        
        // 强制重绘
        container.offsetHeight;

        // 4. 执行动画：滑入视口
        container.style.transition = 'transform 0.5s cubic-bezier(0.4, 0, 0.2, 1)';
        container.style.transform = 'translateY(0)';
    }

    // 启动循环滚动 (每 3 秒滚动一次)
    setInterval(scrollDown, 3000);

    // 模拟实时数据插入 (每 5-10 秒随机触发)
    function scheduleNextUpdate() {
        const delay = Math.random() * 5000 + 5000; // 5000ms - 10000ms
        setTimeout(() => {
            addNewActivity();
            scheduleNextUpdate();
        }, delay);
    }

    function addNewActivity() {
        // 生成新数据
        const newItem = generateRandomActivity(0, true);
        
        // 更新数据数组 (插入到头部)
        activityData.unshift(newItem);
        if (activityData.length > 15) {
            activityData.pop(); // 移除最旧的数据
        }
        
        // 更新 DOM：在最前添加一个新节点
        const div = document.createElement('div');
        div.className = 'flex items-center py-3 border-b border-gray-50 text-xs text-gray-600 hover:bg-gray-50 transition-colors h-[50px] bg-blue-50/30'; //稍微高亮一下
        div.innerHTML = `
            <div class="w-[28%] pl-2 truncate" title="${newItem.college}">${newItem.college}</div>
            <div class="w-[22%] truncate" title="${newItem.course}">${newItem.course}</div>
            <div class="w-[15%] truncate">${newItem.teacher}</div>
            <div class="w-[20%]"><span class="${newItem.actionColor} px-2 py-1 rounded scale-90 inline-block origin-left">${newItem.actionText}</span></div>
            <div class="w-[15%] text-right pr-2 text-blue-500 font-medium text-[10px] whitespace-nowrap">${newItem.time}</div>
        `;
        
        container.insertBefore(div, container.firstElementChild);
        
        // 移除多余的 DOM 节点
        if (container.children.length > activityData.length) {
            container.removeChild(container.lastElementChild);
        }

        // 执行下滑动画效果
        container.style.transition = 'none';
        container.style.transform = `translateY(-${rowHeight}px)`;
        container.offsetHeight; // 强制重绘
        
        container.style.transition = 'transform 0.5s cubic-bezier(0.4, 0, 0.2, 1)';
        container.style.transform = 'translateY(0)';
    }

            scheduleNextUpdate();
        }
    </script>
</body>
</html>